<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mahart Linked Notes - AI Project Showcase</title>
  <link rel="stylesheet" href="css/styles.css"/>
  <link rel="stylesheet" href="css/ai-styles.css"/>
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
  <style>
    /* Additional styles for AI Project Showcase */
    .ai-showcase-header {
      background: linear-gradient(90deg, #0f1115, #151922);
      border-bottom: 1px solid #1f2434;
      padding: 10px 12px;
      margin: -12px -12px 12px -12px;
      text-align: center;
    }
    
    .ai-showcase-header h1 {
      color: #6ee7ff;
      font-size: 1.8em;
      margin: 0;
    }
  </style>
</head>
</head>
<body>
<div class="app">
  <div class="topbar">
    <div style="display: flex; gap: 8px;">
      <button id="newNote" class="btn">New Note (⌘/Ctrl+N)</button>
    </div>
    <button id="saveNote" class="btn">Save (⌘/Ctrl+S)</button>
    <div style="flex: 1; display: flex; gap: 8px; position: relative;">
      <div style="flex: 1; position: relative;">
        <input id="q" type="search" placeholder="Quick search (⌘/Ctrl+K): title, tags, body…" style="width: 100%;" autocomplete="off"/>
        <div id="searchSuggestions" class="search-suggestions" style="display: none;"></div>
      </div>
    </div>
    <button id="tagsBtn" class="btn">Tags</button>
    <button id="graphBtn" class="btn">Graph</button>
    <button id="exportBtn" class="btn">Export</button>
    <button id="importBtn" class="btn">Import</button>
    <button id="settingsBtn" class="btn">Settings</button>
  </div>

  <div class="left">
    <div class="section">
      <strong>Notes</strong> <span id="noteCount" class="badge">0</span>
      <div id="noteList"></div>
    </div>
    <div class="section">
      <strong>Tags</strong> <span id="tagCount" class="badge">0</span>
      <div id="tagList"></div>
    </div>
    <div class="section small">
      <strong>Backlinks</strong>
      <div id="backlinks"></div>
    </div>
  </div>

  <div class="main">
    <div class="card">
      <h3 style="display:flex;align-items:center;gap:8px;padding:12px;">
        Editor <span id="dirty" class="badge" style="display:none;">unsaved</span>
      </h3>
      <div class="editor">
        <textarea id="editor" placeholder="# Title

Write with **Markdown**.
Link notes with [[Note Title]] or [[ID:xxxx]].
Add tags with #tag anywhere.
"></textarea>
        
        <!-- Text Highlighting Controls -->
        <div id="highlightControls" class="highlight-controls" style="display: none;">
          <div class="highlight-controls-header">
            <span>Highlight Text</span>
            <button onclick="UI.autoFixHighlights()" class="btn" style="font-size: 10px; padding: 4px 8px; background: #1b2130; color: #ffd166;" title="Fix broken highlight syntax">Auto-Fix</button>
          </div>
          <div class="color-options">
            <button onclick="UI.applyHighlight('red')" class="color-btn red" title="Red highlight">Red</button>
            <button onclick="UI.applyHighlight('orange')" class="color-btn orange" title="Orange highlight">Orange</button>
            <button onclick="UI.applyHighlight('yellow')" class="color-btn yellow" title="Yellow highlight">Yellow</button>
            <button onclick="UI.applyHighlight('green')" class="color-btn green" title="Green highlight">Green</button>
            <button onclick="UI.applyHighlight('blue')" class="color-btn blue" title="Blue highlight">Blue</button>
            <button onclick="UI.applyHighlight('purple')" class="color-btn purple" title="Purple highlight">Purple</button>
          </div>
          <div class="highlight-actions">
            <button onclick="UI.removeHighlight()" class="btn remove-btn" title="Remove highlight">Remove</button>
          </div>
        </div>
      </div>
      <div class="meta">
        <input id="title" placeholder="Title"/>
        <div id="enhanced-tags-input" class="tag-input-container">
            <div class="tags-display" id="tagsDisplay"></div>
            <input type="text" id="tagInput" class="tag-input-field" placeholder="Add tags..."/>
            <div class="tag-suggestions" id="tagSuggestions"></div>
        </div>
        <button id="saveNoteInline" class="btn" style="margin-left: 8px; padding: 8px 12px;" title="Save note (⌘/Ctrl+S)">Save</button>
      </div>
      <div class="editor-status" id="editorStatus" style="padding: 4px 12px; border-top: 1px solid #1a2133; font-size: 11px; color: var(--muted); background: #0f1422;">
        <span>Words: 0</span> | <span>Chars: 0</span> | <span>Lines: 1</span> | <span>Tags: 0</span> | <span>Links: 0</span>
      </div>
    </div>

    <div class="card">
      <h3 style="padding:12px;">Live Preview</h3>
      <div id="preview" class="preview"></div>
    </div>
  </div>


  <div class="right">
    <div class="panel">
      <div class="kpi">
        <div class="box"><div class="small">Notes</div><div id="kpiNotes" style="font-size:22px;"></div></div>
        <div class="box"><div class="small">Links/Note</div><div id="kpiLinks" style="font-size:22px;"></div></div>
        <div class="box"><div class="small">% ≥2 Links</div><div id="kpiHealth" style="font-size:22px;"></div></div>
      </div>
      <hr class="sep"/>
      <canvas id="chartActivity" height="120"></canvas>
      <hr class="sep"/>
      <div class="graph" id="miniGraph"></div>
    </div>

    <div class="panel small">
      <strong>Performance</strong>
      <div id="perfBox" class="code"></div>
    </div>

    <div class="panel small">
      <strong>Events</strong>
      <div id="eventLog" class="code" style="max-height:160px"></div>
    </div>
  </div>
</div>

<div id="toast" class="toast">Saved</div>

<!-- Tags Management Modal -->
<dialog id="tagsModal">
  <div class="card" style="padding:16px;min-width:600px;max-height:80vh;overflow:auto;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="margin:0;">Tag Management</h3>
      <button class="btn" onclick="el('#tagsModal').close()" style="padding:4px 8px;">×</button>
    </div>
    
    <div style="margin-bottom:16px;">
      <div style="display:flex;gap:8px;margin-bottom:8px;">
        <input id="newTagInput" placeholder="Create new tag (e.g., #project)" style="flex:1;background:#0b0e14;border:1px solid #1f2434;border-radius:8px;color:var(--text);padding:8px;">
        <button class="btn" onclick="UI.createNewTag()">Add Tag</button>
      </div>
      <div style="font-size:11px;color:var(--muted);">Tags are automatically created when you use #hashtags in notes</div>
    </div>

    <div style="display:flex;gap:16px;">
      <div style="flex:1;">
        <h4>All Tags <span id="totalTagCount" class="badge">0</span></h4>
        <div id="allTagsList" style="max-height:300px;overflow:auto;border:1px solid #1a2133;border-radius:8px;padding:8px;"></div>
      </div>
      
      <div style="flex:1;">
        <h4>Tag Details</h4>
        <div id="tagDetails" style="border:1px solid #1a2133;border-radius:8px;padding:12px;min-height:200px;">
          <div style="color:var(--muted);text-align:center;padding:40px 0;">Select a tag to view details</div>
        </div>
      </div>
    </div>

    <div style="margin-top:16px;display:flex;gap:8px;">
      <button class="btn" onclick="UI.exportTags()">Export Tags</button>
      <button class="btn" onclick="UI.cleanupUnusedTags()" style="background:#2d1b1b;color:#ef476f;">Cleanup Unused</button>
      <button class="btn" onclick="el('#tagsModal').close()" style="margin-left:auto;">Close</button>
    </div>
  </div>
</dialog>

<!-- Graph Visualization Modal -->
<dialog id="graphModal">
  <div class="card" style="padding:16px;min-width:800px;max-height:80vh;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="margin:0;">Knowledge Graph</h3>
      <button class="btn" onclick="el('#graphModal').close()" style="padding:4px 8px;">×</button>
    </div>
    
    <div style="margin-bottom:16px;">
      <div style="display:flex;gap:8px;">
        <button class="btn" onclick="UI.renderGraph()">Refresh Graph</button>
        <button class="btn" onclick="UI.centerGraph()">Center View</button>
        <button class="btn" onclick="UI.exportGraph()">Export Image</button>
      </div>
    </div>

    <div id="graphContainer" style="width:100%;height:500px;border:1px solid #1a2133;border-radius:8px;background:#0b0f18;">
      <div style="display:flex;align-items:center;justify-content:center;height:100%;color:var(--muted);">
        Graph will render here
      </div>
    </div>

    <div style="margin-top:16px;">
      <button class="btn" onclick="el('#graphModal').close()">Close</button>
    </div>
  </div>
</dialog>

<dialog id="settings">
  <form method="dialog" class="card" style="padding:16px;min-width:420px">
    <h3>Settings</h3>
    <label class="small">Auto-link on save: <input id="autoLink" type="checkbox" checked></label>
    <label class="small">Enable analytics: <input id="enableAnalytics" type="checkbox" checked></label>
    <label class="small">Realtime multi-tab sync: <input id="enableBC" type="checkbox" checked></label>
    <hr class="sep"/>
    <button class="btn" value="cancel">Close</button>
  </form>
</dialog>

<input id="importFile" type="file" accept="application/json" hidden/>

<!-- Essential scripts only -->
<script src="js/util.js"></script>
<script src="js/store.js"></script>
<script src="js/search.js"></script>
<script src="js/analytics.js"></script>
<script src="js/graph.js"></script>
<script src="js/tags.js"></script>
<script src="js/templates.js"></script>
<script src="js/recommendations.js"></script>
<script src="js/collaboration.js"></script>
<script src="js/graph-analytics.js"></script>
<script src="js/query-engine.js"></script>
<script src="js/advanced-viz.js"></script>
<script src="js/ai-assistant.js"></script>
<script src="js/advanced-ui.js"></script>
<script src="js/plugin-system.js"></script>
<script src="js/data-management.js"></script>
<script src="js/advanced-search.js"></script>
<script src="js/advanced-editor.js"></script>
<script src="js/monetization.js"></script>
<script src="js/workspace.js"></script>
<script src="js/themes.js"></script>
<script src="js/app.js"></script>
<script src="js/init.js"></script>


</body>
</html>
