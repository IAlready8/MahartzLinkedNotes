<!DOCTYPE html>
<html>
<head>
  <title>Test Enterprise Features</title>
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
</head>
<body>
  <h1>Testing Enterprise-Grade Features</h1>
  
  <h2>1. Collaboration System</h2>
  <button onclick="testCollaboration()">Test Collaboration</button>
  <div id="collabResult"></div>
  
  <h2>2. Graph Analytics</h2>
  <button onclick="testGraphAnalytics()">Test Graph Analytics</button>
  <div id="graphResult"></div>
  
  <h2>3. Query Engine</h2>
  <button onclick="testQueryEngine()">Test Query Engine</button>
  <div id="queryResult"></div>
  
  <h2>4. AI Assistant</h2>
  <button onclick="testAIAssistant()">Test AI Assistant</button>
  <div id="aiResult"></div>
  
  <script src="js/util.js"></script>
  <script src="js/store.js"></script>
  <script src="js/search.js"></script>
  <script src="js/analytics.js"></script>
  <script src="js/graph.js"></script>
  <script src="js/tags.js"></script>
  <script src="js/templates.js"></script>
  <script src="js/recommendations.js"></script>
  <script src="js/collaboration.js"></script>
  <script src="js/graph-analytics.js"></script>
  <script src="js/query-engine.js"></script>
  <script src="js/ai-assistant.js"></script>
  
  <script>
    // Test collaboration system
    async function testCollaboration() {
      const result = document.getElementById('collabResult');
      try {
        if (typeof Collaboration !== 'undefined') {
          await Collaboration.init();
          result.innerHTML = '<p style="color: green;">✓ Collaboration system initialized successfully</p>';
          
          // Test user ID generation
          const userId = Collaboration.getUserId();
          result.innerHTML += `<p>User ID: ${userId}</p>`;
          
          // Test peer count
          const peerCount = Collaboration.getPeerCount();
          result.innerHTML += `<p>Peers: ${peerCount}</p>`;
        } else {
          result.innerHTML = '<p style="color: red;">✗ Collaboration system not found</p>';
        }
      } catch (e) {
        result.innerHTML = '<p style="color: red;">Error: ' + e.message + '</p>';
      }
    }
    
    // Test graph analytics
    async function testGraphAnalytics() {
      const result = document.getElementById('graphResult');
      try {
        if (typeof GraphAnalytics !== 'undefined') {
          // Create test notes
          const testNotes = [
            { 
              id: '1', 
              title: 'AI Research', 
              body: 'Research on artificial intelligence and machine learning algorithms', 
              tags: ['#research', '#ai', '#ml'], 
              links: ['2', '3'], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            },
            { 
              id: '2', 
              title: 'Machine Learning Basics', 
              body: 'Introduction to ML concepts and techniques', 
              tags: ['#ml', '#tutorial'], 
              links: ['1'], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            },
            { 
              id: '3', 
              title: 'Data Science', 
              body: 'Data analysis and visualization techniques', 
              tags: ['#data', '#science'], 
              links: ['1'], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            }
          ];
          
          // Calculate metrics
          const metrics = await GraphAnalytics.calculateMetrics(testNotes);
          result.innerHTML = '<p style="color: green;">✓ Graph analytics calculated successfully</p>';
          result.innerHTML += `<p>Nodes: ${metrics.totalNodes}, Edges: ${metrics.totalEdges}</p>`;
          result.innerHTML += `<p>Density: ${(metrics.density * 100).toFixed(1)}%</p>`;
          result.innerHTML += `<p>Clustering: ${metrics.clusteringCoefficient.toFixed(3)}</p>`;
          
          // Generate insights
          const insights = GraphAnalytics.generateInsights(metrics, testNotes);
          result.innerHTML += `<p>Insights generated: ${insights.length}</p>`;
        } else {
          result.innerHTML = '<p style="color: red;">✗ GraphAnalytics not found</p>';
        }
      } catch (e) {
        result.innerHTML = '<p style="color: red;">Error: ' + e.message + '</p>';
      }
    }
    
    // Test query engine
    async function testQueryEngine() {
      const result = document.getElementById('queryResult');
      try {
        if (typeof QueryEngine !== 'undefined') {
          // Create test notes
          const testNotes = [
            { 
              id: '1', 
              title: 'AI Research Notes', 
              body: 'Important research on artificial intelligence', 
              tags: ['#research', '#ai', '#important'], 
              links: ['2'], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            },
            { 
              id: '2', 
              title: 'ML Tutorial', 
              body: 'Machine learning tutorial for beginners', 
              tags: ['#ml', '#tutorial'], 
              links: [], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            }
          ];
          
          // Test search
          const searchResults = await QueryEngine.search('ai research', testNotes);
          result.innerHTML = '<p style="color: green;">✓ Query engine search successful</p>';
          result.innerHTML += `<p>Search results: ${searchResults.length}</p>`;
          
          // Test simple query
          const queryResults = await QueryEngine.execute('SELECT title, tags_count WHERE tags_count > 0', testNotes);
          result.innerHTML += `<p>Query results: ${queryResults.length}</p>`;
          
          // Test aggregation
          const aggResults = await QueryEngine.aggregate('SELECT COUNT(*)', testNotes);
          result.innerHTML += `<p>Aggregated notes: ${aggResults.count}</p>`;
        } else {
          result.innerHTML = '<p style="color: red;">✗ QueryEngine not found</p>';
        }
      } catch (e) {
        result.innerHTML = '<p style="color: red;">Error: ' + e.message + '</p>';
      }
    }
    
    // Test AI assistant
    async function testAIAssistant() {
      const result = document.getElementById('aiResult');
      try {
        if (typeof AIAssistant !== 'undefined') {
          // Create test notes
          const testNotes = [
            { 
              id: '1', 
              title: 'Project Planning', 
              body: 'How to plan a software project effectively', 
              tags: ['#project', '#planning'], 
              links: [], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            },
            { 
              id: '2', 
              title: 'Task Management', 
              body: 'Best practices for task management and productivity', 
              tags: ['#productivity', '#todo'], 
              links: ['1'], 
              createdAt: new Date().toISOString(), 
              updatedAt: new Date().toISOString() 
            }
          ];
          
          // Test suggestions
          const suggestions = await AIAssistant.generateSuggestions(testNotes);
          result.innerHTML = '<p style="color: green;">✓ AI assistant suggestions generated</p>';
          result.innerHTML += `<p>Suggestions: ${suggestions.length}</p>`;
          
          // Test question answering
          const answer = await AIAssistant.answerQuestion('How to create links?', testNotes);
          result.innerHTML += '<p>Question answering: ✓</p>';
          
          // Test summary generation
          const summary = await AIAssistant.generateSummary(testNotes[0]);
          result.innerHTML += '<p>Summary generation: ✓</p>';
        } else {
          result.innerHTML = '<p style="color: red;">✗ AIAssistant not found</p>';
        }
      } catch (e) {
        result.innerHTML = '<p style="color: red;">Error: ' + e.message + '</p>';
      }
    }
  </script>
</body>
</html>